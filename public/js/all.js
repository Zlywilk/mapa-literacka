function init(){"use strict";function e(e){var t,i,n,o,a,l,s,r,d,h,c,g,p=0;$.get("lastid/"+y,function(e,u){var v=e.length;for(p;v>p;p++)n=new google.maps.LatLng(e[p].latitude,e[p].longitude),o=e[p].title,a=e[p].id,l=e[p].type,d=e[p].user_id,t=e[p].opis,h=e[p].image,i=e[p].repair,c=e[p].addres,s={url:e[p].gfx,size:new google.maps.Size(40,40),origin:null,anchor:null},v-1===p&&(y=e[p].id),g=new google.maps.Marker({position:n,map:f,icon:s,title:o,id:a,image:h,type:l,opis:t,repair:i,addres:c}),b(g,f),r=g.type,m[r].push(g)})}function t(e){for(var t=0;t<m[e].length;t++){var i=m[e][t];i.getVisible()?i.setVisible(!1):i.setVisible(!0)}}function i(){for(var e=1;10>e;e++)for(var t=m[e].length,i=0;t>i;i++){var n=m[e][i];n.getVisible()||n.setVisible(!0)}}function n(t,i){if(void 0!==arguments[2])var n=arguments[2];$.ajax({type:i,url:"markers",contentType:"aplication/json",data:t,success:function(t){"POST"===i&&$(".globalmesage").addClass("alert-success").append("melduje wykonanie zadania markery zostały dodane").fadeIn(),"DELETE"===i&&$(".globalmesage").addClass("alert-success").append("Bomba usunąłem marker ale już go nie odzyskasz :D").fadeIn(),"PATCH"===i&&$(".globalmesage").addClass("alert-success").append("exh znów coś chcesz? <br> No nic musze to zrobić w końcu jestem programaem gotowe markery edytowane").fadeIn(),void 0!==n?(r(n),e(y)):"PATCH"!==i&&(r("all"),e(y))}}).fail(function(e){if(500===e.status)return void $(".globalmesage").addClass("alert-danger").html("coś poszło nie tak nasze minionki juz pracują nad rozwizaniem problemu :)").fadeIn();var t=e.responseJSON;$.each(t,function(e,t){var i=e.split(".");void 0!==n&&(i[1]=n),void 0===i[1]&&(i[1]=0),$(".error"+i[1]).append(t),$(".error"+i[1]).fadeIn()})})}function o(e){var t=$(".panelholding").length;$(".panelholding:last").attr("id",t-1),e.find(".deltable").val(""),e.find('input[type="checkbox"]').prop("checked",!1),e.find(".repair").val("0"),e.find(".alert-danger").hide(),e.find(".alert-danger").empty(),e.find(".alert-danger").attr("class","error"+t+" alert alert-danger")}function a(e){if(""===$(".latitude").val())$(".panelholding").removeClass("addnewmarker"),$(".panel-heading").addClass("edit").html(e.title+w),$(".panel-body").find(".btn-group").append('<button type="button" data-dismiss="modal" class="btn btn-sm btn-default destroy" >usuń</button>'),$(".panel-body").find(".form-group").append('<input class="form-control editid" name="editid"   type="hidden" >'),$(".panel-body").find(".title").val(e.title),$(".panel-body").find(".addres").val(e.addres),$(".panel-body").find(".opis").val(e.opis),$(".panel-body").find(".editid").val(e.id),$(".panel-body").find(".send").removeClass("send").addClass("editsend"),$(".panel-body").find(".type").val(e.type),$(".panel-body").find(".repair").val(e.repair),$(".panel-body").find(".latitude").val(e.position.lat()),$(".panel-body").find(".longitude").val(e.position.lng());else{var t=$(".panelholding:first").clone();t.hasClass("addnewmarker")&&(t.find(".btn-group").append('<button type="button" data-dismiss="modal" class="btn btn-sm btn-default destroy" >usuń</button>'),t.find(".form-group").append('<input class="form-control editid" name="editid"   type="hidden" >')),t.removeClass("addnewmarker"),t.find(".panel-heading").addClass("edit").html(e.title+w),t.find(".title").val(e.title),t.find(".addres").val(e.addres),t.find(".opis").val(e.opis),t.find(".editid").val(e.id),t.find(".send").removeClass("send").addClass("editsend"),t.find(".type").val(e.type),t.find(".repair").val(e.repair),t.find(".latitude").val(e.position.lat()),t.find(".longitude").val(e.position.lng()),$(".all").before(t),o(t)}$("body").on("click",".destroy",function(t){t.preventDefault();var i=$(this).closest(".panel-body").find(".editid").val();$(this).closest(".panelholding");$(".modal").modal().one("click","#destroy",function(t){n(i,"DELETE"),$(".globalmesage").addClass("alert-success").html("Bomba usunąłem marker ale już go nie odzyskasz :D").fadeIn(),e.setMap(null),$(".close").click()})})}function l(e,t,i){var n,o;"string"==typeof e?(n={address:e},o=1):(n={latLng:e},o=0),g.geocode(n,function(e,t){if(t==google.maps.GeocoderStatus.OK){if(1===o)return void d(e[0].geometry.location,f);f.setCenter(e[0].geometry.location);var n=e[0].geometry.location.lat(),a=e[0].geometry.location.lng();$("input[name='latitude']").eq(i).val(n),$("input[name='longitude']").eq(i).val(a),$(".addres").eq(i).val(e[0].formatted_address)}})}function s(){$(".panel-heading").eq(0).html("marker"+w),$(".deltable").val(""),$('input[type="checkbox"]').prop("checked",!1),$(".repair").val(0),$(".type").val(null)}function r(e){var t=$(".panelholding"),i=t.length;if("all"===e){var n=$(".addnewmarker");n.each(function(e){v[e].setMap(null)});for(var o=1;i>o;o++)t.eq(o).remove();return s(),v.length>0&&v[0].setMap(null),v.splice(0,i),void(c=0)}if(1===i)return s(),1===v.length&&v[e].setMap(null),v.splice(e,1),void(c=0);$(e).fadeOut(),t[e].remove(),v.length>=1&&v[e].setMap(null),v.splice(e,1);var a=e,l=$(".panelholding"),r=l.length;for(a;r>a;a++)l.eq(a).attr("id",a),v[a].id=a}function d(e,t){var i=(v.length,$(".addnewmarker").length),n=$(".panelholding").length,a=$(".panelholding:first").clone(),s=new google.maps.Marker({id:n,position:e,label:h[c++%h.length],map:t,draggable:!0});v.push(s),f.setCenter(e),google.maps.event.addListener(s,"dragend",function(e){var t=this.id;l(e.latLng,0,t)}),i>=0&&(a.find(".panel-heading:first").hasClass("edit")&&(a.addClass("addnewmarker"),a.find(".edit").removeClass("edit"),a.find(".destroy").remove(),a.find(".editsend").attr("class","btn btn-sm btn-default clickable send"),a.find(".panel-heading").html("marker"+w),$(".editid").remove()),$(".all").before(a),l(e,0,n),o(a))}var h="ABCDEFGHIJKLMNOPQRSTUVWXYZ",c=0,g=new google.maps.Geocoder,p={zoom:14,center:new google.maps.LatLng(53.0137902,18.5984437),disableDefaultUI:!0,scrollwheel:!0,draggable:!0,zoomControl:!0,fullscreenControl:!0},u=document.getElementById("map"),f=new google.maps.Map(u,p),m={1:[],2:[],3:[],4:[],5:[],6:[],7:[],8:[],9:[],10:[]},v=[],y=null,w='<span class="pull-right cancel clickable"><i class="fa fa-times"></i></span>';e(y);var b=function(e,t){google.maps.event.addListener(e,"click",function(){var i='<h4 style="margin:2px ">'+e.title+'</h4><p style="margin:0px">'+e.opis+"</p>";if(void 0!==e.image){var n='<img src="'+e.image+'" alt="'+e.title+'">';i+=n}var o=new google.maps.InfoWindow({content:i});if(o.open(t,e),"2"===$("#roleid").val()||$("#userid").val()===e.userid){var l=$(".panelholding").length;e.setDraggable(!0);var s=$(".edit").length;if(s>=1){var r=0,d=0;for(r;s>=r;r++)$(".editid").eq(r).val()===e.id.toString()&&++d,0===d&&a(e)}else e.editid=l,a(e)}else e.setDraggable(!1)}),google.maps.event.addListener(e,"dragend",function(e){var t=this.editid;l(e.latLng,0,t)})};$("body").on("change","#cboxLoadedContent input",function(){t(this.value)});var x=document.getElementById("legend");f.controls[google.maps.ControlPosition.TOP_CENTER].push(x),$("#toggle").click(function(){$("#sidebar-wrapper").toggleClass("hide")}),$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}}),$(".ajax").on("click",function(e){e.preventDefault(),$(".ajax").colorbox({top:50,left:50}),i()}),"Idź do UL."===$(".city").html()&&($("body").on("change",".required",function(){var e=$(this).closest(".panel-body");"text"===this.type&&e.prev().html(this.value+w),e.find(".alert-danger").fadeOut()}),google.maps.event.addListener(f,"click",function(e){d(e.latLng,f)}),$(".city").click(function(e){e.preventDefault();var t=$("#city").val()+",87-100 Toruń";l(t,1)}),$("body").on("click",".panel-heading",function(){$(this).next("div").slideToggle("slow")}),$("body").on("click",".clickable",function(e){var t=$(this).closest(".panelholding"),i=t.attr("id"),o=$(".addnewmarker");if(e.preventDefault(),$(this).hasClass("cancel"))r(i);else if($(this).hasClass("cancelall"))r("all");else if($(this).hasClass("send")){t.find(".alert-danger").empty();var a=JSON.stringify(t.serializeObject());n(a,"post",i)}else if($(this).hasClass("sendall")){$(".alert").fadeOut("fast",function(){$(this).html("")}),$(".globalmesage").removeClass("alert-success, alert-danger");var l=JSON.stringify(o.serializeObject());n(l,"post");var s=$(".edit").length;if(s>0){var d=$(".edit").next(),h=JSON.stringify(d.serializeObject());n(h,"PATCH",i)}}else if($(this).hasClass("editsend")){var c=($(this).closest(".panel-body").find(".editid").val(),$(this).closest(".panelholding")),g=JSON.stringify(c.serializeObject());n(g,"PATCH")}}),$("body").on("change",'input[type="checkbox"]',function(){$(this).val(this.checked?1:0)}),$.fn.serializeObject=function(){var e={},t='input[type="hidden"], input[type="text"], input[type="password"]';return t+=',input[type="checkbox"], input[type="radio"]:checked',t+=',select, textarea, input[type="file"] ',$(this).find(t).each(function(){if("hidden"==$(this).attr("type")){var t=$(this).parent(),i=t.find('input[type="checkbox"][name="'+this.name.replace(/\[/g,"\\[").replace(/\]/g,"\\]")+'"]');if(null!==i&&i.prop("checked"))return}if(null!==this.name&&void 0!==this.name&&""!==this.name){var n=null;n=$(this).is("select")?$(this).find("option:selected").val():this.value,void 0!==e[this.name]?(e[this.name].push||(e[this.name]=[e[this.name]]),e[this.name].push(n||"")):e[this.name]=n||""}}),e}),f.controls[google.maps.ControlPosition.TOP_LEFT].push()}google.maps.event.addDomListener(window,"load",init),function(e,t,i){function n(i,n,o){var a=t.createElement(i);return n&&(a.id=Z+n),o&&(a.style.cssText=o),e(a)}function o(){return i.innerHeight?i.innerHeight:e(i).height()}function a(t,i){i!==Object(i)&&(i={}),this.cache={},this.el=t,this.value=function(t){var n;return void 0===this.cache[t]&&(n=e(this.el).attr("data-cbox-"+t),void 0!==n?this.cache[t]=n:void 0!==i[t]?this.cache[t]=i[t]:void 0!==X[t]&&(this.cache[t]=X[t])),this.cache[t]},this.get=function(t){var i=this.value(t);return e.isFunction(i)?i.call(this.el,this):i}}function l(e){var t=L.length,i=(_+e)%t;return 0>i?t+i:i}function s(e,t){return Math.round((/%/.test(e)?("x"===t?z.width():o())/100:1)*parseInt(e,10))}function r(e,t){return e.get("photo")||e.get("photoRegex").test(t)}function d(e,t){return e.get("retinaUrl")&&i.devicePixelRatio>1?t.replace(e.get("photoRegex"),e.get("retinaSuffix")):t}function h(e){"contains"in w[0]&&!w[0].contains(e.target)&&e.target!==y[0]&&(e.stopPropagation(),w.focus())}function c(e){c.str!==e&&(w.add(y).removeClass(c.str).addClass(e),c.str=e)}function g(t){_=0,t&&t!==!1&&"nofollow"!==t?(L=e("."+ee).filter(function(){var i=e.data(this,Y),n=new a(this,i);return n.get("rel")===t}),_=L.index(B.el),-1===_&&(L=L.add(B.el),_=L.length-1)):L=e(B.el)}function p(i){e(t).trigger(i),se.triggerHandler(i)}function u(i){var o;if(!V){if(o=e(i).data(Y),B=new a(i,o),g(B.get("rel")),!A){A=J=!0,c(B.get("className")),w.css({visibility:"hidden",display:"block",opacity:""}),E=n(re,"LoadedContent","width:0; height:0; overflow:hidden; visibility:hidden"),$.css({width:"",height:""}).append(E),F=x.height()+T.height()+$.outerHeight(!0)-$.height(),N=C.width()+k.width()+$.outerWidth(!0)-$.width(),R=E.outerHeight(!0),K=E.outerWidth(!0);var l=s(B.get("initialWidth"),"x"),r=s(B.get("initialHeight"),"y"),d=B.get("maxWidth"),u=B.get("maxHeight");B.w=Math.max((d!==!1?Math.min(l,s(d,"x")):l)-K-N,0),B.h=Math.max((u!==!1?Math.min(r,s(u,"y")):r)-R-F,0),E.css({width:"",height:B.h}),G.position(),p(te),B.get("onOpen"),W.add(M).hide(),w.focus(),B.get("trapFocus")&&t.addEventListener&&(t.addEventListener("focus",h,!0),se.one(ae,function(){t.removeEventListener("focus",h,!0)})),B.get("returnFocus")&&se.one(ae,function(){e(B.el).focus()})}var f=parseFloat(B.get("opacity"));y.css({opacity:f===f?f:"",cursor:B.get("overlayClose")?"pointer":"",visibility:"visible"}).show(),B.get("closeButton")?P.html(B.get("close")).appendTo($):P.appendTo("<div/>"),v()}}function f(){w||(Q=!1,z=e(i),w=n(re).attr({id:Y,"class":e.support.opacity===!1?Z+"IE":"",role:"dialog",tabindex:"-1"}).hide(),y=n(re,"Overlay").hide(),I=e([n(re,"LoadingOverlay")[0],n(re,"LoadingGraphic")[0]]),b=n(re,"Wrapper"),$=n(re,"Content").append(M=n(re,"Title"),j=n(re,"Current"),D=e('<button type="button"/>').attr({id:Z+"Previous"}),S=e('<button type="button"/>').attr({id:Z+"Next"}),H=n("button","Slideshow"),I),P=e('<button type="button"/>').attr({id:Z+"Close"}),b.append(n(re).append(n(re,"TopLeft"),x=n(re,"TopCenter"),n(re,"TopRight")),n(re,!1,"clear:left").append(C=n(re,"MiddleLeft"),$,k=n(re,"MiddleRight")),n(re,!1,"clear:left").append(n(re,"BottomLeft"),T=n(re,"BottomCenter"),n(re,"BottomRight"))).find("div div").css({"float":"left"}),O=n(re,!1,"position:absolute; width:9999px; visibility:hidden; display:none; max-width:none;"),W=S.add(D).add(j).add(H)),t.body&&!w.parent().length&&e(t.body).append(y,w.append(b,O))}function m(){function i(e){e.which>1||e.shiftKey||e.altKey||e.metaKey||e.ctrlKey||(e.preventDefault(),u(this))}return w?(Q||(Q=!0,S.click(function(){G.next()}),D.click(function(){G.prev()}),P.click(function(){G.close()}),y.click(function(){B.get("overlayClose")&&G.close()}),e(t).bind("keydown."+Z,function(e){var t=e.keyCode;A&&B.get("escKey")&&27===t&&(e.preventDefault(),G.close()),A&&B.get("arrowKey")&&L[1]&&!e.altKey&&(37===t?(e.preventDefault(),D.click()):39===t&&(e.preventDefault(),S.click()))}),e.isFunction(e.fn.on)?e(t).on("click."+Z,"."+ee,i):e("."+ee).live("click."+Z,i)),!0):!1}function v(){var t,o,a,l=G.prep,h=++de;if(J=!0,q=!1,p(le),p(ie),B.get("onLoad"),B.h=B.get("height")?s(B.get("height"),"y")-R-F:B.get("innerHeight")&&s(B.get("innerHeight"),"y"),B.w=B.get("width")?s(B.get("width"),"x")-K-N:B.get("innerWidth")&&s(B.get("innerWidth"),"x"),B.mw=B.w,B.mh=B.h,B.get("maxWidth")&&(B.mw=s(B.get("maxWidth"),"x")-K-N,B.mw=B.w&&B.w<B.mw?B.w:B.mw),B.get("maxHeight")&&(B.mh=s(B.get("maxHeight"),"y")-R-F,B.mh=B.h&&B.h<B.mh?B.h:B.mh),t=B.get("href"),U=setTimeout(function(){I.show()},100),B.get("inline")){var c=e(t);a=e("<div>").hide().insertBefore(c),se.one(le,function(){a.replaceWith(c)}),l(c)}else B.get("iframe")?l(" "):B.get("html")?l(B.get("html")):r(B,t)?(t=d(B,t),q=B.get("createImg"),e(q).addClass(Z+"Photo").bind("error."+Z,function(){l(n(re,"Error").html(B.get("imgError")))}).one("load",function(){h===de&&setTimeout(function(){var t;B.get("retinaImage")&&i.devicePixelRatio>1&&(q.height=q.height/i.devicePixelRatio,q.width=q.width/i.devicePixelRatio),B.get("scalePhotos")&&(o=function(){q.height-=q.height*t,q.width-=q.width*t},B.mw&&q.width>B.mw&&(t=(q.width-B.mw)/q.width,o()),B.mh&&q.height>B.mh&&(t=(q.height-B.mh)/q.height,o())),B.h&&(q.style.marginTop=Math.max(B.mh-q.height,0)/2+"px"),L[1]&&(B.get("loop")||L[_+1])&&(q.style.cursor="pointer",e(q).bind("click."+Z,function(){G.next()})),q.style.width=q.width+"px",q.style.height=q.height+"px",l(q)},1)}),q.src=t):t&&O.load(t,B.get("data"),function(t,i){h===de&&l("error"===i?n(re,"Error").html(B.get("xhrError")):e(this).contents())})}var y,w,b,$,x,C,k,T,L,z,E,O,I,M,j,H,S,D,P,W,B,F,N,R,K,_,q,A,J,V,U,G,Q,X={html:!1,photo:!1,iframe:!1,inline:!1,transition:"elastic",speed:300,fadeOut:300,width:!1,initialWidth:"600",innerWidth:!1,maxWidth:!1,height:!1,initialHeight:"450",innerHeight:!1,maxHeight:!1,scalePhotos:!0,scrolling:!0,opacity:.9,preloading:!0,className:!1,overlayClose:!0,escKey:!0,arrowKey:!0,top:!1,bottom:!1,left:!1,right:!1,fixed:!1,data:void 0,closeButton:!0,fastIframe:!0,open:!1,reposition:!0,loop:!0,slideshow:!1,slideshowAuto:!0,slideshowSpeed:2500,slideshowStart:"start slideshow",slideshowStop:"stop slideshow",photoRegex:/\.(gif|png|jp(e|g|eg)|bmp|ico|webp|jxr|svg)((#|\?).*)?$/i,retinaImage:!1,retinaUrl:!1,retinaSuffix:"@2x.$1",current:"image {current} of {total}",previous:"previous",next:"next",close:"close",xhrError:"This content failed to load.",imgError:"This image failed to load.",returnFocus:!0,trapFocus:!0,onOpen:!1,onLoad:!1,onComplete:!1,onCleanup:!1,onClosed:!1,rel:function(){return this.rel},href:function(){return e(this).attr("href")},title:function(){return this.title},createImg:function(){var t=new Image,i=e(this).data("cbox-img-attrs");return"object"==typeof i&&e.each(i,function(e,i){t[e]=i}),t},createIframe:function(){var i=t.createElement("iframe"),n=e(this).data("cbox-iframe-attrs");return"object"==typeof n&&e.each(n,function(e,t){i[e]=t}),"frameBorder"in i&&(i.frameBorder=0),"allowTransparency"in i&&(i.allowTransparency="true"),i.name=(new Date).getTime(),i.allowFullscreen=!0,i}},Y="colorbox",Z="cbox",ee=Z+"Element",te=Z+"_open",ie=Z+"_load",ne=Z+"_complete",oe=Z+"_cleanup",ae=Z+"_closed",le=Z+"_purge",se=e("<a/>"),re="div",de=0,he={},ce=function(){function e(){clearTimeout(l)}function t(){(B.get("loop")||L[_+1])&&(e(),l=setTimeout(G.next,B.get("slideshowSpeed")))}function i(){H.html(B.get("slideshowStop")).unbind(r).one(r,n),se.bind(ne,t).bind(ie,e),w.removeClass(s+"off").addClass(s+"on")}function n(){e(),se.unbind(ne,t).unbind(ie,e),H.html(B.get("slideshowStart")).unbind(r).one(r,function(){G.next(),i()}),w.removeClass(s+"on").addClass(s+"off")}function o(){a=!1,H.hide(),e(),se.unbind(ne,t).unbind(ie,e),w.removeClass(s+"off "+s+"on")}var a,l,s=Z+"Slideshow_",r="click."+Z;return function(){a?B.get("slideshow")||(se.unbind(oe,o),o()):B.get("slideshow")&&L[1]&&(a=!0,se.one(oe,o),B.get("slideshowAuto")?i():n(),H.show())}}();e[Y]||(e(f),G=e.fn[Y]=e[Y]=function(t,i){var n,o=this;return t=t||{},e.isFunction(o)&&(o=e("<a/>"),t.open=!0),o[0]?(f(),m()&&(i&&(t.onComplete=i),o.each(function(){var i=e.data(this,Y)||{};e.data(this,Y,e.extend(i,t))}).addClass(ee),n=new a(o[0],t),n.get("open")&&u(o[0])),o):o},G.position=function(t,i){function n(){x[0].style.width=T[0].style.width=$[0].style.width=parseInt(w[0].style.width,10)-N+"px",$[0].style.height=C[0].style.height=k[0].style.height=parseInt(w[0].style.height,10)-F+"px"}var a,l,r,d=0,h=0,c=w.offset();if(z.unbind("resize."+Z),w.css({top:-9e4,left:-9e4}),l=z.scrollTop(),r=z.scrollLeft(),B.get("fixed")?(c.top-=l,c.left-=r,w.css({position:"fixed"})):(d=l,h=r,w.css({position:"absolute"})),h+=B.get("right")!==!1?Math.max(z.width()-B.w-K-N-s(B.get("right"),"x"),0):B.get("left")!==!1?s(B.get("left"),"x"):Math.round(Math.max(z.width()-B.w-K-N,0)/2),d+=B.get("bottom")!==!1?Math.max(o()-B.h-R-F-s(B.get("bottom"),"y"),0):B.get("top")!==!1?s(B.get("top"),"y"):Math.round(Math.max(o()-B.h-R-F,0)/2),w.css({top:c.top,left:c.left,visibility:"visible"}),b[0].style.width=b[0].style.height="9999px",a={width:B.w+K+N,height:B.h+R+F,top:d,left:h},t){var g=0;e.each(a,function(e){return a[e]!==he[e]?void(g=t):void 0}),t=g}he=a,t||w.css(a),w.dequeue().animate(a,{duration:t||0,complete:function(){n(),J=!1,b[0].style.width=B.w+K+N+"px",b[0].style.height=B.h+R+F+"px",B.get("reposition")&&setTimeout(function(){z.bind("resize."+Z,G.position)},1),e.isFunction(i)&&i()},step:n})},G.resize=function(e){var t;A&&(e=e||{},e.width&&(B.w=s(e.width,"x")-K-N),e.innerWidth&&(B.w=s(e.innerWidth,"x")),E.css({width:B.w}),e.height&&(B.h=s(e.height,"y")-R-F),e.innerHeight&&(B.h=s(e.innerHeight,"y")),e.innerHeight||e.height||(t=E.scrollTop(),E.css({height:"auto"}),B.h=E.height()),E.css({height:B.h}),t&&E.scrollTop(t),G.position("none"===B.get("transition")?0:B.get("speed")))},G.prep=function(i){function o(){return B.w=B.w||E.width(),B.w=B.mw&&B.mw<B.w?B.mw:B.w,B.w}function s(){return B.h=B.h||E.height(),B.h=B.mh&&B.mh<B.h?B.mh:B.h,B.h}if(A){var h,g="none"===B.get("transition")?0:B.get("speed");E.remove(),E=n(re,"LoadedContent").append(i),E.hide().appendTo(O.show()).css({width:o(),overflow:B.get("scrolling")?"auto":"hidden"}).css({height:s()}).prependTo($),O.hide(),e(q).css({"float":"none"}),c(B.get("className")),h=function(){function i(){e.support.opacity===!1&&w[0].style.removeAttribute("filter")}var n,o,s=L.length;A&&(o=function(){clearTimeout(U),I.hide(),p(ne),B.get("onComplete")},M.html(B.get("title")).show(),E.show(),s>1?("string"==typeof B.get("current")&&j.html(B.get("current").replace("{current}",_+1).replace("{total}",s)).show(),S[B.get("loop")||s-1>_?"show":"hide"]().html(B.get("next")),D[B.get("loop")||_?"show":"hide"]().html(B.get("previous")),ce(),B.get("preloading")&&e.each([l(-1),l(1)],function(){var i,n=L[this],o=new a(n,e.data(n,Y)),l=o.get("href");l&&r(o,l)&&(l=d(o,l),i=t.createElement("img"),i.src=l)})):W.hide(),B.get("iframe")?(n=B.get("createIframe"),B.get("scrolling")||(n.scrolling="no"),e(n).attr({src:B.get("href"),"class":Z+"Iframe"}).one("load",o).appendTo(E),se.one(le,function(){n.src="//about:blank"}),B.get("fastIframe")&&e(n).trigger("load")):o(),"fade"===B.get("transition")?w.fadeTo(g,1,i):i())},"fade"===B.get("transition")?w.fadeTo(g,0,function(){G.position(0,h)}):G.position(g,h)}},G.next=function(){!J&&L[1]&&(B.get("loop")||L[_+1])&&(_=l(1),u(L[_]))},G.prev=function(){!J&&L[1]&&(B.get("loop")||_)&&(_=l(-1),u(L[_]))},G.close=function(){A&&!V&&(V=!0,A=!1,p(oe),B.get("onCleanup"),z.unbind("."+Z),y.fadeTo(B.get("fadeOut")||0,0),w.stop().fadeTo(B.get("fadeOut")||0,0,function(){w.hide(),y.hide(),p(le),E.remove(),setTimeout(function(){V=!1,p(ae),B.get("onClosed")},1)}))},G.remove=function(){w&&(w.stop(),e[Y].close(),w.stop(!1,!0).remove(),y.remove(),V=!1,w=null,e("."+ee).removeData(Y).removeClass(ee),e(t).unbind("click."+Z).unbind("keydown."+Z))},G.element=function(){return e(B.el)},G.settings=X)}(jQuery,document,window);
